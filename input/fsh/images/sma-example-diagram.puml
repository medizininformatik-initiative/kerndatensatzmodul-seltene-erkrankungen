@startuml SMA_Case_Resources_Diagram
!define DARKBLUE #1e3a5f
!define LIGHTBLUE #4a86e8
!define GREEN #0d9488
!define ORANGE #ea580c
!define PURPLE #7c3aed
!define RED #dc2626
!define YELLOW #facc15

skinparam backgroundColor #f8f9fa
skinparam roundcorner 10
skinparam shadowing true
skinparam ArrowColor #666666
skinparam ArrowThickness 2

skinparam class {
    BackgroundColor<<Patient>> DARKBLUE
    BorderColor<<Patient>> DARKBLUE
    FontColor<<Patient>> white
    
    BackgroundColor<<Condition>> RED
    BorderColor<<Condition>> RED
    FontColor<<Condition>> white
    
    BackgroundColor<<Observation>> GREEN
    BorderColor<<Observation>> GREEN
    FontColor<<Observation>> white
    
    BackgroundColor<<Procedure>> PURPLE
    BorderColor<<Procedure>> PURPLE
    FontColor<<Procedure>> white
    
    BackgroundColor<<Encounter>> ORANGE
    BorderColor<<Encounter>> ORANGE
    FontColor<<Encounter>> white
    
    BackgroundColor<<FamilyHistory>> LIGHTBLUE
    BorderColor<<FamilyHistory>> LIGHTBLUE
    FontColor<<FamilyHistory>> white
}

' Patient at the center
class "patient-sma-001" <<Patient>> {
    Neugeborenes Mädchen
    Geburt: ~01.07.2024
    ID: SMA-2024-001
}

' Diagnosis progression (left side)
class "condition-sma-suspected" <<Condition>> {
    **Verdacht auf SMA**
    Status: unconfirmed
    Feststellung: 18.07.2024
    Quelle: Neugeborenenscreening
}

class "condition-sma-clinical" <<Condition>> {
    **Klinische Diagnose SMA Typ 1**
    Status: provisional
    ICD-10: G12.0
    Orpha: 83330
    Feststellung: 22.07.2024
}

class "condition-sma-confirmed" <<Condition>> {
    **Bestätigte SMA Typ 1**
    Status: confirmed
    ICD-10: G12.0
    Orpha: 83330
    Feststellung: 26.07.2024
    Onset: Neonatal
}

' Genetic findings (top)
class "variant-smn1-001" <<Observation>> {
    **SMN1 Deletion**
    Kopien: 0 (homozygot)
    Status: Pathologisch
    Datum: 26.07.2024
}

class "variant-smn2-001" <<Observation>> {
    **SMN2 Kopienanzahl**
    Kopien: 2
    Modifikator
    Datum: 26.07.2024
}

' Gene therapy (right)
class "procedure-gentherapy-001" <<Procedure>> {
    **Gentherapie**
    OPS: 6-00d.0
    Datum: 29.07.2024
    Mit Prednisolon
}

' Family history (bottom left)
class "family-history-001" <<FamilyHistory>> {
    **Urgroßmutter**
    Unbekannte Muskelerkrankung
    Relation: unsicher
    Datum: 22.07.2024
}

' Encounters (bottom)
class "encounter-screening-001" <<Encounter>> {
    **Neugeborenenscreening**
    Datum: 18.07.2024
    Typ: Screening
}

class "encounter-ambulant-001" <<Encounter>> {
    **Erstvorstellung**
    Datum: 22.07.2024
    Typ: Ambulant
    SMA-Zentrum
}

class "encounter-stationaer-001" <<Encounter>> {
    **Stationär für Gentherapie**
    Datum: 29-30.07.2024
    Typ: Stationär
}

class "encounter-nachsorge-001" <<Encounter>> {
    **Nachsorge**
    Datum: 12.08.2024
    Typ: Ambulant
}

' Lab observations (right side)
class "observation-troponin-series" <<Observation>> {
    **Troponin T hs**
    22.07: 92 ng/l ↑
    28.07: 58 ng/l ↑
    01.08: 57 ng/l ↑
    12.08: 106 ng/l ↑
}

class "observation-liver-plt" <<Observation>> {
    **ALT, AST, Thrombozyten**
    Post-therapeutisch
    Status: Normwertig
    Datum: 29.07.2024
}

' Relationships - Patient at center
"patient-sma-001" <-- "condition-sma-suspected" : subject
"patient-sma-001" <-- "condition-sma-clinical" : subject
"patient-sma-001" <-- "condition-sma-confirmed" : subject
"patient-sma-001" <-- "variant-smn1-001" : subject
"patient-sma-001" <-- "variant-smn2-001" : subject
"patient-sma-001" <-- "procedure-gentherapy-001" : subject
"patient-sma-001" <-- "family-history-001" : patient
"patient-sma-001" <-- "observation-troponin-series" : subject
"patient-sma-001" <-- "observation-liver-plt" : subject

' Diagnosis progression chain
"condition-sma-suspected" <-- "condition-sma-clinical" : stage.assessment
"condition-sma-clinical" <-- "condition-sma-confirmed" : stage.assessment

' Evidence links
"condition-sma-confirmed" --> "variant-smn1-001" : evidence
"condition-sma-confirmed" --> "variant-smn2-001" : evidence

' Procedure reason
"procedure-gentherapy-001" --> "condition-sma-confirmed" : reasonReference

' Encounter diagnosis links
"encounter-screening-001" ..> "condition-sma-suspected" : identifies
"encounter-ambulant-001" --> "condition-sma-clinical" : diagnosis
"encounter-stationaer-001" --> "condition-sma-confirmed" : diagnosis
"encounter-nachsorge-001" --> "condition-sma-confirmed" : diagnosis

' Encounter patient links
"patient-sma-001" <-- "encounter-screening-001" : subject
"patient-sma-001" <-- "encounter-ambulant-001" : subject
"patient-sma-001" <-- "encounter-stationaer-001" : subject
"patient-sma-001" <-- "encounter-nachsorge-001" : subject

' Procedure encounter link
"encounter-stationaer-001" <.. "procedure-gentherapy-001" : context

' Timeline annotation
note right of "condition-sma-suspected"
  **Diagnose-Verlauf:**
  1. Verdacht (18.07)
  2. Klinisch (22.07)
  3. Bestätigt (26.07)
end note

note left of "observation-troponin-series"
  **Troponin bereits**
  **prätherapeutisch erhöht**
end note

legend bottom center
|= Legende |
| <color:white,back:DARKBLUE>Patient</color> | Zentrale Patientenressource |
| <color:white,back:RED>Condition</color> | Diagnosen mit Verlauf |
| <color:white,back:GREEN>Observation</color> | Labor & Genetik |
| <color:white,back:PURPLE>Procedure</color> | Gentherapie |
| <color:white,back:ORANGE>Encounter</color> | Kontakte |
| <color:white,back:LIGHTBLUE>FamilyHistory</color> | Familienanamnese |
| → | Referenz |
| ⋯> | Assoziiation |
endlegend

@enduml